---
title: "STAT2000: Applied Statistics and Research Methods"
output: 
  html_document: 
    css: Labs.css
params:
  inc_solu:
    label: Include solutions
    value: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

if ( ! require('haven'))
  install.packages('haven')
if ( ! require('car'))
  install.packages('car')

data <- haven::read_sav('Lab 05 - Activity.sav')
data <- as.data.frame(data)
data$TrmntGrp <- as.factor(data$TrmntGrp)
```

```{block include=(!params$inc_solu)}
<style>
.section.level5 {
  display: none ;
}
</style>
```

# Lab 5 - Week 6

#### Recall Lecture 4:

 - Part 1. Brief Review - Comparing Means: Post-hoc tests (unplanned comparisons)
 - Part 2. Comparing Means: a priori tests (planned comparisons)(Mod 5, Sect 5.2)
 - Part 3. Two-Way ANOVA (Mod 6) 

### Lab Objectives

On completion of this lab you will be able to:

 - Test assumptions for a one-way fixed effects ANOVA.


### Overview

In the Week 5 lecture we discussed unplanned (review) and planned comparisons – within the latter we introduced orthogonal contrasts (a series of null hypotheses we wish to test, which are determined before the data have been analysed). We also began the extension analysis, two-way fixed effects ANOVA.

#### Data Files

```{r echo=FALSE}
xfun::embed_file("Lab 05 - Activity.sav")
```  
<br>
```{r echo=FALSE}
xfun::embed_file("Lab 05 - Recall.sav")
```



## 5.1 Two Way ANOVA

Recall the example provided in Lecture 5

 - Does one’s mood influence how well things are remembered? A psychologist decides to research this question using two factors. 
 - Factor A represents the emotional condition under which the subjects are required to learn a list of words. Subjects are made to feel either happy or sad. 
 - Factor B represents the emotional condition under which the subject’s memory is tested. Subjects are made to feel happy or sad before they are told to recall words
 - The response variable is the number of words recalled. The data appears in *Lab 05 - Recall.sav*.

Number of words recalled for given levels of mood during learning and at recall.

#### 1. Express the two-way ANOVA model required for analysing this data algebraically (i.e., in terms of a mathematical equation). Clearly define all the symbols in the context of this example.

##### Solutions

 

With two fixed factors, the ANOVA model is:

$$ Y_{ijk} =  \mu_{ij} + \epsilon_{ijk} $$
$$ Y_{ijk} =  \mu + \alpha_i + \beta_j + \alpha\beta_{ij} + \epsilon_{ijk} $$

where in this example  

 - $i$ = 1 or 2 identifying a Sad or Happy mood when learning the list of words.
 - $j$ = 1 or 2 identifying a Sad or Happy mood when recalling the list of words.
 - $k$ = 1,…, 5 distinguishes the 5 different subjects within each treatment group.
 - $Y_{ijk}$ is the number of words recalled by the kth subject in the cell corresponding to the ith level of learning mood and the jth level of recall mood.
 - $\mu_{ij}$ is the population mean number of words recalled for a (theoretical) population of people who learnt the list in mood i and recalled the list in mood j. Thus it is the population mean corresponding to each treatment and can be broken down into components using $\mu_{ij} = \mu + \alpha_i + \beta_j + \alpha\beta_{ij}$
 - $\mu$ is the overall population mean number of words remembered across all learning moods and recall moods.
 - $\alpha_i$ is the fixed effect of the ith learning mood on the number of words remembered.
 - $\beta_j$ is the fixed effect of the jth recall mood on the number of words remembered.
 - $\alpha\beta_{ij}$ is the interaction effect of the ith learning mood and jth recall mood on the number of words remembered.
 - $\epsilon_{ijk}$ is the error term of the observation, $Y_{ijk}$, assumed to be distributed normally with a mean of zero and variance of $\sigma^2$. It is the remaining unexplained variation after the effects of learning mood and recall mood and any interaction effect have been accounted for.

#### 2. Fit the appropriate ANOVA model. Record the means and obtain plots of the factor level (group) sample means for each factor to enable a visual consideration of the effects of the factors.

![](R.svg)

It's possible to use a number of different functions to achieve this, but for the sake of expedience, let's use the *jmv* package's `ANOVA()` function.

```{r, eval=FALSE}
library(jmv)
data <- haven::read_sav('Lab 05 - Recall.sav')
data <- as.data.frame(data)

ANOVA(
  data = data,
  formula = WordsRecalled ~ LearningMood * RecallMood,
  emMeans = ~LearningMood+RecallMood+LearningMood:RecallMood,
  emmTables = TRUE)
```

![](v.svg)

Analyses -> ANOVA -> ANOVA. This is a two-way ANOVA, so we'll be specifying two factors this time. We want to produce 3 plots, one plot showing the main-effect of `LearningMood`, one plot showing the main-effect of `RecallMood`, and one plot showing the interaction between `LearningMood` and `RecallMood`. To create these plots, come down to the *Estimated Marginal Means* section. In this section, we can specify the *terms* that we want to plot. To begin with, add `LearningMood` into *Term 1*. This should produce a main-effect plot of `LearningMood`. To create a second plot, click "+ New Term". This will provide you with a slot to add `RecallMood` into; providing a plot of its main-effect. Finally, click "+ New Term" again, and this time add *both* `LearningMood` and `RecallMood` into that term box. This will produce an *interaction plot* of `LearningMood` and `RecallMood`.

##### Solutions

 

```{r}
library(jmv)
data <- haven::read_sav('Lab 05 - Recall.sav')
data <- as.data.frame(data)

ANOVA(
  data = data,
  formula = WordsRecalled ~ LearningMood * RecallMood,
  emMeans = ~LearningMood+RecallMood+LearningMood:RecallMood,
  emmTables = TRUE)
```

#### 3. Write the relevant null and alternative hypotheses for testing whether there is an interaction between the mood during learning and the mood during recall in how these factors relate to the number of words recalled. What is the relevant test statistic, p-value and your decision?

##### Solutions

 

 $H_0: \alpha\beta_{ij} = 0$ for all i, j
 
 $H_a: \alpha\beta_{ij} ≠ 0$ for at least one i, j pair

The relevant test statistic is F = 985.80, associated p-value < 0.001 and thus $H_0$ is rejected.

#### 4. Write the relevant null and alternative hypotheses for testing whether the mood during learning has an effect on the number of words recalled. What is the relevant test statistic, p-value and your decision?

##### Solutions

 

 $H_0: \alpha_i = 0$ for all i

 $H_a: \alpha_i ≠ 0$ for at least one i
 
The relevant test statistic is F = 47.07, associated p-value < 0.001 and thus $H_0$  is rejected.

#### 5. Write the relevant null and alternative hypotheses for testing whether the mood during recall has an effect on the number of words recalled. What is the relevant test statistic, p-value and your decision?

##### Solutions

 

 $H_0: \beta_j = 0$ for all j
 
 $H_a: \beta_j ≠ 0$ for at least one j
 
The relevant test statistic is F = 1.10, associated p-value = 0.310 and thus $H_0$  is not rejected.

#### 6. Provide a concluding paragraph that would be appropriate to include in a report summarising the results of this research.

##### Solutions

 

There is a statistically significant interaction effect on the population mean number of words recalled due to both the mood when learning and mood when recalling (p < .001); this is also evident from the graph which shows the difference in means  for a given level of mood at recall is affected by the level of mood when learning. Mood at recall does not itself have a statistically significant effect on the population mean number of words recalled (p=0.31) whilst mood when learning does (p < .001).

The key finding is that the effect of recall moods on the response variable is completely different depending on the level of the mood when learning the words (the interaction effect). 

We are 95% confident that the population mean number of words recalled when:

 - Happy at both learning and recall lies between 83.4 and 88.6
 - Sad at both learning and recall lies between 73.6 and 78.8
 - Happy at learning and sad at recall lies between 43.2 and 48.4
 - Sad at learning and happy at recall lies between 36.0 and 41.2

#### 7. Use this example to explain why is it important to always check for an interaction effect before interpreting the main effects.

##### Solutions

 

Someone who just looked at the output superficially may look at the results of the test of the effect of recall mood and declare that it has no statistically significant effect based on the p-value of 0.31. If you look at the means plot for the recall mood factor it certainly shows that averaged over the levels of the learning mood factor there is no effect of recall mood on the number of words recalled. However, in this case, it is certainly not correct to say that recall mood does not have an effect. Recall mood has a very large effect but the effect depends on the level of the learning mood factor’s level. 

This is why you should always check for an interaction effect first before trying to test for the significance of individual factors or interpret what is really happening.





## 5.4 Group Project

Are you on track to complete your project proposal? Discuss ideas with your tutor. 

